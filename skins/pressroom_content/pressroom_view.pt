<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="pressroom">

<body>

    <div metal:fill-slot="main">
    <metal:main-macro define-macro="main"
                      tal:define='toLocalizedTime nocall:here/toLocalizedTime;
                                  viewReleaseAmt context/getNum_releases | nothing;
                                  viewClipAmt context/getNum_clips | nothing;
                                  showContacts context/getShow_contacts;
                                  showReleases context/getShow_releases;
                                  showClips context/getShow_clips;'>

        <div metal:use-macro="here/document_actions/macros/document_actions">
            Document actions (print, sendto etc)
        </div>

        <h1 tal:content="object_title" class="documentFirstHeading">
            Title or id
        </h1>

        <p class="documentDescription"
           tal:content="here/Description"
           tal:condition="here/Description">
            Description
        </p>
        <div class="stx">
            <div tal:replace="structure here/getText | nothing" />
        </div>
                
 
     <div id="press-contacts"
                         tal:define="path python:'/'.join(context.getPhysicalPath());
                                     testStr python: 'testValue';
                                     use_view_action site_properties/typesUseViewActionInListings|python:();
                                     show_about python:not isAnon or site_properties.allowAnonymousViewAbout;
                                     pressContacts python:context.portal_catalog.searchResults(meta_type = 'PressContact', review_state='published', path=path,);"
                         tal:condition="python: (pressContacts and showContacts) or (showContacts and checkPermission('Add_Portal_Content', context))">
                              <h3 class="pressroomSection">
                            Press Contacts
                                   
                              <span tal:condition="python:checkPermission('Add_Portal_Content', context)" 
                                    class="addPressRoomItem">
                                   <a href="./press-contacts/createObject?type_name=PressContact">
                                   [Add Press Contact]
                                   </a>
                              </span>
                        </h3>
                        
                        <dl>
                            <tal:entry tal:condition="pressContacts" 
                                       tal:repeat="item pressContacts">
                                <tal:block tal:define="item_url item/getURL|item/absolute_url;
                                                       item_id item/getId|item/id;
                                                       item_title_or_id item/pretty_title_or_id;
                                                       item_description item/Description;
                                                       item_subhead item/getSubhead;
                                                       item_type item/portal_type;
                                                       item_type_title item/Type;
                                                       item_modified item/ModificationDate;
                                                       item_created item/CreationDate;
                                                       item_effective item/EffectiveDate;
                                                       item_type_class python: 'contenttype-' + normalizeString(item_type);
                                                       item_wf_state item/review_state|python: wtool.getInfoFor(item, 'review_state', '');
                                                       item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                                                       item_creator item/Creator;">
                                    
                                    <dt metal:define-macro='contactlist'>
                                        <span tal:attributes="class item_type_class">
                                            <a href="#" 
                                               tal:attributes="href python:test(item_type in use_view_action, item_url+'/view', item_url+'/');
                                                               class string:$item_wf_state_class visualIconPadding"
                                               tal:content="item_title_or_id">
                                                Item Title
                                            </a>
                                                       
                                           
                                                <metal:description define-slot="description_slot">
                                                    <tal:comment replace="nothing"> 
                                                        Place custom listing info for custom types here
                                                    </tal:comment>
                                                </metal:description>
                                        </span>
                                    </dt>
                                    
                                    <dd>
                                                  <div tal:condition="item_subhead"
                                                        tal:content="item_subhead"
                                                        class="pressroomSubhead">
                                                       Subheading
                                                  </div>
     
                                        <div tal:omit-tag="" tal:condition="not:item_description"> 
                                            &nbsp; 
                                        </div> 
                                        <div tal:omit-tag="" tal:content="item_description"> 
                                            description 
                                        </div> 
                                    </dd>
                                    </tal:block>
                                </tal:entry>
                            </dl>
                    </div>   
        
                      <tal:block 
                           tal:define="path python:'/'.join(context.getPhysicalPath());
                                                      pressReleases python:context.portal_catalog.searchResults(meta_type = 'PressRelease',review_state='published',sort_order='reverse',path=path,sort_on='getReleaseDate',)[:viewReleaseAmt]">
                    <div id='press-releases'
                        tal:condition="python: (pressReleases and showReleases) or (showReleases and checkPermission('Add_Portal_Content', context))">
                          
                        <h3 class="pressroomSection">
                            Recent Press Releases
                                   
                              <span tal:condition="python:checkPermission('Add_Portal_Content', context)" 
                                    class="addPressRoomItem">
                                   <a href="./press-releases/createObject?type_name=PressRelease">
                                   [Add Press Release]
                                   </a>
                              </span> 
                        </h3>
                
                        <tal:listing condition="pressReleases"
                                     define="use_view_action site_properties/typesUseViewActionInListings|python:();
                                            show_about python:not isAnon or site_properties.allowAnonymousViewAbout;
                                            ">
                
                            <dl>
                                <tal:entry tal:repeat="item pressReleases">
                                <tal:block tal:define="item_url item/getURL|item/absolute_url;
                                                       item_id item/getId|item/id;
                                                       item_title_or_id item/pretty_title_or_id;
                                                       item_description item/Description;
                                                       item_subhead item/getSubhead;
                                                       item_type item/portal_type;
                                                       item_type_title item/Type;
                                                       item_modified item/ModificationDate;
                                                       item_created item/CreationDate;
                                                       item_release item/getReleaseDate;
                                                       item_type_class python: 'contenttype-' + normalizeString(item_type);
                                                       item_wf_state item/review_state|python: wtool.getInfoFor(item, 'review_state', '');
                                                       item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                                                       item_creator item/Creator;
                                                   ">
                
                                    <dt metal:define-macro="releaselistitem">
                
                                        <span tal:attributes="class item_type_class">
                                        <a href="#" 
                                           tal:attributes="href python:test(item_type in use_view_action, item_url+'/view', item_url+'/');
                                                           class string:$item_wf_state_class visualIconPadding"
                                           tal:content="item_title_or_id">
                                            Item Title
                                        </a>
                                        </span>
         
                                        <span class="itemDate"
                                         tal:content="python:toLocalizedTime(item_release)">
                                         August 8, 2006
                                        </span>
                
                                        
                                            <metal:description define-slot="description_slot">
                                                <tal:comment replace="nothing"> 
                                                    Place custom listing info for custom types here
                                                </tal:comment>
                                            </metal:description>
                                    </dt>
                
                                    <dd>
                                                  <div tal:condition="item_subhead"
                                                       tal:content="item_subhead"
                                                        class="pressroomSubhead">
                                                       Subheading
                                                  </div>
     
                                        <div tal:omit-tag="" tal:condition="not:item_description"> 
                                            &nbsp; 
                                        </div> 
                                        <div tal:omit-tag="" tal:content="item_description"> 
                                            description 
                                        </div> 
                                    </dd>
                                  </tal:block>
                                </tal:entry>
                            </dl>
                        </tal:listing>
                        <p class="discreet"
                           tal:condition="not:pressReleases"
                           i18n:translate="description_no_items_in_folder">
                            There are currently no press releases.
                        </p>
                              
                              <div class="morePressRoomItems">
                                   <a href="./press-releases">
                                   More Press Releases
                                   </a>
                              </div>
                    </div>
                 </tal:block>   
                    
                    
                    <tal:block
                     tal:define="path python:'/'.join(context.getPhysicalPath());
                                     pressClips python:context.portal_catalog.searchResults(meta_type = 'PressClip',review_state='published',sort_order='reverse',path=path,sort_on='getStorydate',)[:viewClipAmt];">
            
                    <div id="press-clips"
                       tal:condition="python: (pressClips and showClips) or (showClips and checkPermission('Add_Portal_Content', context))">
                            <h3 class="pressroomSection">Recent Press Clips
                                   
                              <span tal:condition="python:checkPermission('Add_Portal_Content', context)" 
                                    class="addPressRoomItem">
                                   <a href="./press-clips/createObject?type_name=PressClip">
                                   [Add Press Clip]
                                   </a>
                              </span>  
                        </h3>
                
                        <tal:listing condition="pressClips"
                                     define="use_view_action site_properties/typesUseViewActionInListings|python:();
                                             show_about python:not isAnon or site_properties.allowAnonymousViewAbout;">
                
                            <dl>
                                <tal:entry tal:repeat="item pressClips">
                                <tal:block tal:define="item_url item/getURL|item/absolute_url;
                                                       item_id item/getId|item/id;
                                                       item_title_or_id item/pretty_title_or_id;
                                                       item_description item/Description;
                                                       item_type item/portal_type;
                                                       item_type_title item/Type;
                                                       item_modified item/ModificationDate;
                                                       item_created item/CreationDate;
                                                       item_storydate item/getStorydate;
                                                       item_type_class python: 'contenttype-' + normalizeString(item_type);
                                                       item_wf_state        item/review_state|python: wtool.getInfoFor(item, 'review_state', '');
                                                       item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                                                       item_creator item/Creator;
                                                   ">
                
                                    <dt metal:define-macro="cliplistitem">
                
                                        <span tal:attributes="class item_type_class">
                                        <a href="#" 
                                           tal:attributes="href python:test(item_type in use_view_action, item_url+'/view', item_url+'/');
                                                           class string:$item_wf_state_class visualIconPadding"
                                           tal:content="item_title_or_id">
                                            Item Title
                                        </a>
                                        </span>
                                        
                                        <span class="itemDate"
                                         tal:content="python:toLocalizedTime(item_storydate)">
                                         Story Date
                                        </span>
                
                                        
                
                                    </dt>
                
                                    <dd>
                                        <span tal:omit-tag="" tal:condition="not:item_description"> 
                                            &nbsp; 
                                        </span> 
                                        <span tal:omit-tag="" tal:content="item_description"> 
                                            description 
                                        </span> 
                                    </dd>
    
                                </tal:block>
                                </tal:entry>
                            </dl>
                        </tal:listing>
                    
                        <p class="discreet"
                           tal:condition="not:pressClips"
                           i18n:translate="description_no_items_in_folder">
                            There are currently no press clips.
                        </p>

                              <div class="morePressRoomItems">
                                   <a href="./press-clips">
                                   More Press Clips
                                   </a>
                              </div>
                    </div>
                 </tal:block> 
                    

    </metal:main-macro>
    </div>

</body>
</html>
